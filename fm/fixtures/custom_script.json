[
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Vehicle", 
  "modified": "2017-06-03 17:08:44.157229", 
  "name": "Vehicle-Client", 
  "script": "frappe.ui.form.on('Vehicle', {\n    renew: function(frm) {\n        if (frm.doc.amount > 0) {\n            if (!frm.doc.rate || frm.doc.rate <= 0) {\n                frappe.db.get_value(\"FM Configuration\", \"\", \"simple_rate_of_interest\", function(d) {\n                    frm.set_value(\"rate\", d.simple_rate_of_interest)\n                });\n            }\n            var amount = Math.ceil((cur_frm.doc.amount * (1 + cur_frm.doc.rate / 100)) / 3);\n            var date = \"\"\n\t\t\t\n            frappe.call({\n                method: \"fm.utilities.get_next_repayment_schedule\",\n                args: {\n                    \"Docs\": frm.doc,\n                    \"chasis_no\": frm.doc.chassis_no\n                },\n                callback: function(r) {\n                    if (r) {  \n\t\t\t\t\t\tdate=new Date(r.message);\n\t\t\t\t\t\tconsole.log(\"Message: \"+r.message+\"\\nDate: \"+date)\n\t\t\t\t\t\tfrm.clear_table(\"cuotas\");\n\t\t\t\t\t\tfor (i = 0; i < 3; i++) {\n\t\t\t\t\t\t\tfrm.add_child(\"cuotas\", {\n\t\t\t\t\t\t\t\t\"date\": date,\n\t\t\t\t\t\t\t\t\"amount\": amount,\n\t\t\t\t\t\t\t\t\"status\": \"PENDING\"\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tdate = addMonthsUTC(date, 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trefresh_field(\"cuotas\");\n\t\t\t\t\t}\n                }\n            });\n\t\t\t\n        } else frappe.msgprint(\"EL MONTO de la poliza debe ser mayor que cero\")\n    }\n});\n\nfunction addMonthsUTC(date, count) {\n    if (date && count) {\n        var m, d = (date = new Date(+date)).getUTCDate()\n        date.setUTCMonth(date.getUTCMonth() + count, 1)\n        m = date.getUTCMonth()\n        date.setUTCDate(d)\n        if (date.getUTCMonth() !== m) date.setUTCDate(0)\n    }\n    return date\n}", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Translation", 
  "modified": "2017-05-03 16:23:21.040330", 
  "name": "Translation-Client", 
  "script": "frappe.ui.form.on(\"Translation\", {\n    refresh: function(frm) {\n        if(frm.doc.__islocal) return\n        frm.add_custom_button(__(\"Duplicate\"), function(event){\n            frm.doc.source_name = \"\"\n            frm.doc.target_name = \"\"\n            frm.copy_doc()\n        })\n    }\n})\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "ToDo", 
  "modified": "2017-05-12 03:03:01.791672", 
  "name": "ToDo-Client", 
  "script": "frappe.ui.form.on(\"ToDo\", {\n\tonload: function(frm){\n  \t\tfrm.set_df_property(\"reference_name\", \"read_only\", frm.doc.reference_type==\"Loan\")\n\t}\n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Journal Entry", 
  "modified": "2017-05-16 17:16:29.321334", 
  "name": "Journal Entry-Client", 
  "script": "frappe.ui.form.on(\"Journal Entry\", {\n    on_submit: function(frm) {\n        // create a new Array from the history\n        var new_history = Array.from(frappe.route_history)\n\n        // then reversed the new history array\n        var reversed_history = new_history.reverse()\n\n        // not found flag to stop the bucle\n        var not_found = true\n\n        // iterate the array to find the last Loan visited\n        $.each(reversed_history, function(idx, value) {\n            \n            // see if there is a Loan that was visited in this\n            // section. if found it the redirects the browser to\n            // asumming that the user came from that Loan\n            if (not_found && \"Form\" == value[0] && \"Loan\" == value[1]) {\n\n                // give a timeout before switching the location\n                setTimeout(function() {\n                    // set the route to the latest opened Loan\n                    frappe.set_route(value)\n                }, 1500)\n\n                // set the flag to false to finish\n                not_found = false\n            }\n        })\n    }\n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Payment Entry", 
  "modified": "2017-05-16 19:05:10.416842", 
  "name": "Payment Entry-Client", 
  "script": "frappe.ui.form.on(\"Payment Entry\", {\n    on_submit: function(frm) {\n        // create a new Array from the history\n        var new_history = Array.from(frappe.route_history)\n\n        // then reversed the new history array\n        var reversed_history = new_history.reverse()\n\n        // not found flag to stop the bucle\n        var not_found = true\n\n        // iterate the array to find the last Loan visited\n        $.each(reversed_history, function(idx, value) {\n            \n            // see if there is a Loan that was visited in this\n            // section. if found it the redirects the browser to\n            // asumming that the user came from that Loan\n            if (not_found && \"Form\" == value[0] && \"Loan\" == value[1]) {\n\n                // give a timeout before switching the location\n                setTimeout(function() {\n                    // set the route to the latest opened Loan\n                    frappe.set_route(value)\n                }, 1500)\n\n                // set the flag to false to finish\n                not_found = false\n            }\n        })\n    }\n})", 
  "script_type": "Client"
 }
]